<!DOCTYPE html>
<html lang="es">

<head>
    <title>Lectura Viva - Contacto</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        .full-height {
            min-height: 100vh;
        }
        
        .contact-icon {
            width: 30px;
            height: 30px;
        }
    </style>
</head>

<body class="bg-dark text-white">

    <nav class="navbar navbar-expand-sm navbar-dark bg-secondary sticky-top">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="#">Lectura Viva</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mynavbar">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="Inicio.html">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Catalogo.html">Catálogo</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="Contacto.html">Contacto</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="User.html">Usuario</a>
                    </li>
                </ul>
                <a href="#" class="btn btn-primary d-flex align-items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cart me-2" viewBox="0 0 16 16">
                        <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L4.215 8.2A1.5 1.5 0 0 0 5.69 9.5H12.5a.5.5 0 0 1 0 1H5.69a2.5 2.5 0 0 1-2.29-1.558L1.71 4H.5a.5.5 0 0 1-.5-.5M6.25 14a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3m7-3a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3"/>
                    </svg> Carrito
                </a>
            </div>
        </div>
    </nav>

    <div class="container py-5 full-height">

        <h1 class="mb-4 text-center">Contáctanos</h1>

        <div class="row justify-content-center g-4">

            <div class="col-md-7">
                <div class="card bg-secondary text-white p-4 shadow-lg">
                    <h4 class="mb-4">Envíanos un Mensaje</h4>
                    <form id="contactForm" onsubmit="sendContactForm(event)">
                        <div class="mb-3">
                            <label for="inputName" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="inputName" required>
                        </div>
                        <div class="mb-3">
                            <label for="inputEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="inputEmail" required>
                        </div>
                        <div class="mb-4">
                            <label for="inputMessage" class="form-label">Mensaje</label>
                            <textarea class="form-control" id="inputMessage" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary w-100" id="sendButton">Enviar Mensaje</button>
                        <p id="messageStatus" class="mt-3 text-center"></p>
                    </form>
                </div>
            </div>

            <div class="col-md-4">
                <div class="card bg-secondary text-white p-4 shadow-lg">
                    <h4 class="mb-4">Detalles de Contacto</h4>
                    <ul class="list-group list-group-flush">

                        <li class="list-group-item bg-secondary text-white d-flex align-items-start border-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-envelope me-3 mt-1 contact-icon text-info" viewBox="0 0 16 16">
                                <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-7 4.2-7-4.2V12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"/>
                            </svg>
                            <div>
                                <h6 class="mb-0">Email</h6>
                                <p class="mb-0 small text-muted">contacto@lecturaviva.cl</p>
                            </div>
                        </li>

                        <li class="list-group-item bg-secondary text-white d-flex align-items-start border-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-geo-alt-fill me-3 mt-1 contact-icon text-info" viewBox="0 0 16 16">
                                <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10m0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6"/>
                            </svg>
                            <div>
                                <h6 class="mb-0">Dirección</h6>
                                <p class="mb-0 small text-muted">Avenida Siempre Viva 742, Santiago</p>
                            </div>
                        </li>

                        <li class="list-group-item bg-secondary text-white d-flex align-items-start border-0">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-telephone-fill me-3 mt-1 contact-icon text-info" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1.885.511a1.745 1.745 0 0 1 1.493.383l1.549.582a.7.7 0 0 1 .37.775l-.427 1.018a1.745 1.745 0 0 1-2.305.687L.552 3.654a.7.7 0 0 1-.37-.775L.609 1.866a1.745 1.745 0 0 1 1.276-1.355M11.666 11.666a.7.7 0 0 1 0 1.018l-.427 1.018a1.745 1.745 0 0 1-2.305.687l-1.549-.582a.7.7 0 0 1-.37-.775l.427-1.018c.045-.108.067-.225.067-.342V4.747a.7.7 0 0 1-.067-.342l-.427-1.018a.7.7 0 0 1 .37-.775l1.549-.582a1.745 1.745 0 0 1 2.305.687l.427 1.018z"/>
                            </svg>
                            <div>
                                <h6 class="mb-0">Teléfono</h6>
                                <p class="mb-0 small text-muted">+56 9 1234 5678</p>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // *** IMPORTANTE: Confirma que esta URL es la correcta para tu servidor GraphQL ***
        const API_URL = 'http://127.0.0.1:53490';

        // Mutación GraphQL para enviar el mensaje de contacto
        // Asume que tu esquema tiene una mutación llamada 'sendContactMessage'
        const CONTACT_MUTATION = `
            mutation SendContactMessage($name: String!, $email: String!, $message: String!) {
                sendContactMessage(name: $name, email: $email, message: $message)
            }
        `;

        async function sendContactForm(event) {
            event.preventDefault();

            const name = document.getElementById('inputName').value;
            const email = document.getElementById('inputEmail').value;
            const message = document.getElementById('inputMessage').value;

            const statusElement = document.getElementById('messageStatus');
            const sendButton = document.getElementById('sendButton');

            statusElement.textContent = ''; // Limpiar mensajes anteriores
            sendButton.disabled = true;
            sendButton.textContent = "Enviando...";

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: CONTACT_MUTATION,
                        variables: {
                            name: name,
                            email: email,
                            message: message
                        }
                    }),
                });

                const result = await response.json();

                if (result.errors) {
                    console.error("Error GraphQL:", result.errors);
                    statusElement.textContent = `Error al enviar: ${result.errors[0].message}`;
                    statusElement.classList.remove('text-success');
                    statusElement.classList.add('text-danger');
                } else if (result.data && result.data.sendContactMessage) {
                    // La mutación devolvió éxito (asumimos que devuelve true o un mensaje de éxito)
                    statusElement.textContent = "¡Mensaje enviado con éxito! Te responderemos pronto.";
                    statusElement.classList.remove('text-danger');
                    statusElement.classList.add('text-success');

                    // Limpia el formulario
                    document.getElementById('contactForm').reset();

                } else {
                    statusElement.textContent = "Error desconocido al procesar el envío.";
                    statusElement.classList.remove('text-success');
                    statusElement.classList.add('text-danger');
                }

            } catch (error) {
                console.error("Error de conexión:", error);
                statusElement.textContent = "Error de red: No se pudo conectar con el servidor.";
                statusElement.classList.remove('text-success');
                statusElement.classList.add('text-danger');
            } finally {
                sendButton.disabled = false;
                sendButton.textContent = "Enviar Mensaje";
            }
        }
    </script>
</body>

</html>